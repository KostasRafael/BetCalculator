<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./assets/components/single-team-container/single-team-container.css">
    <link rel="stylesheet" href="./assets/components/fixtures-row/fixtures-row.css">
    <link rel="stylesheet" href="./assets/components/close-button/close-button.css">
    <link rel="stylesheet" href="./assets/components/navigation/navigation.css">
    <link rel="stylesheet" href="./assets/components/next-fixture-row/next-fixture-row.css">
    <link rel="stylesheet" href="./home.css" type="text/css">
</head>

<body>
    <navigation-custom></navigation-custom>
    <div class="main-container">
        <section class="laptop-next-fixtures">
            <div class="keyboard-screen">
                <div class="screen">
                    <div class="data-div data-div-one"> </div>
                    <div class="data-div data-div-two"></div>
                </div>

                <div class="all-teams-container"></div>
            </div>

            <div class="next-fixtures-container"></div>
        </section>
    </div>
    <script src="./functions.js"></script>
    <script src="./assets/components/next-fixture-row/next-fixture-row.js"></script>
    <script src="https://kit.fontawesome.com/50ab0d686f.js" crossorigin="anonymous"></script>
    <script src="./assets/components/navigation/navigation.js"></script>
    <script src="./assets/components/close-button/close-button.js"></script>
    <script src="./assets/components/fixtures-row/fixtures-row.js"></script>
    <script src="./assets/components/single-team-container/single-team-container.js" type="module" defer></script>
</body>
<script>

    /*   const allTeams = {
           manchesterUnited: { name: "Manchester United", id: 33, fixturesArray: [], logo: "" },
           newcastle: { name: "Newcastle", id: 34, fixturesArray: [], logo: "" },
           bournmouth: { name: "Bournemouth", id: 35, fixturesArray: [], logo: "" },
           fulham: { name: "Fulham", id: 36, fixturesArray: [], logo: "" },
           wolves: { name: "Wolves", id: 39, fixturesArray: [], logo: "" },
           liverpool: { name: "Liverpool", id: 40, fixturesArray: [], logo: "" },
           arsenal: { name: "Arsenal", id: 42, fixturesArray: [], logo: "" },
           burnley: { name: "Burnley", id: 44, fixturesArray: [], logo: "" },
           everton: { name: "Everton", id: 45, fixturesArray: [], logo: "" },
           tottenham: { name: "Tottenham", id: 47, fixturesArray: [], logo: "" },
           westham: { name: "Westham", id: 48, fixturesArray: [], logo: "" },
           chelsea: { name: "Chelsea", id: 49, fixturesArray: [], logo: "" },
           mancity: { name: "Mancity", id: 50, fixturesArray: [], logo: "" },
           brighton: { name: "Brighton", id: 51, fixturesArray: [], logo: "" },
           crystalpalace: { name: "Crystalpalace", id: 52, fixturesArray: [], logo: "" },
           brentford: { name: "Brentford", id: 55, fixturesArray: [], logo: "" },
           leedsunited: { name: "Leedsunited", id: 63, fixturesArray: [], logo: "" },
           nottmforest: { name: "Nottmforest", id: 65, fixturesArray: [], logo: "" },
           astonvilla: { name: "Astonvilla", id: 66, fixturesArray: [], logo: "" },
           sunderland: { name: "Sunderland", id: 746, fixturesArray: [], logo: "" }
       };
       */

    const leagueId = 39;
    const nextFixturesContainer = document.querySelector(".next-fixtures-container");
    fetchNextFixtures(39);


    async function renderTeams(leagueId) {
        const allLeagueTeams = await readyAllTeams(leagueId);
        const allTeamsContainer = document.querySelector(".all-teams-container");
        const allTeamsArray = Object.entries(allLeagueTeams);
        allTeamsArray.forEach((team) => {
            const teamId = team[1].id;
            const teamName = team[1].name;
            const teamLogo = team[1].logo;
            const teamNameOneWord = teamName.split(" ")[0];
            const teamContainer = document.createElement("single-team-container");
            teamContainer.classList.add("team-div");
            teamContainer.classList.add(teamNameOneWord);
            teamContainer.setAttribute("team-id", teamId);
            teamContainer.setAttribute("team-name", teamName);
            teamContainer.setAttribute("team-logo", teamLogo);
            allTeamsContainer.appendChild(teamContainer);
        })
    }

    renderTeams(leagueId);

    fetchNextFixtures(leagueId);



    const screen = document.querySelector(".screen");
    const dataDivOne = document.querySelector(".data-div-one");
    const dataDivTwo = document.querySelector(".data-div-two");


    const headers = {
        "x-rapidapi-host": "v3.football.api-sports.io",
        "x-rapidapi-key": "94d01bff67718f85de3f0532069fbbf1",
    };

    // The clickedTeamFixturesArray is passed where the function is called in the
    async function displayTeamFixtures(teamId) {
        const response = await fetch(`https://v3.football.api-sports.io/fixtures?team=${teamId}&league=${leagueId}&season=2025&last=10`, { headers });
        const responseJson = await response.json();
        const fixtures = responseJson.response;
        console.log("fixtures i function", fixtures);
        // Huge: allFixturesDiv is created only once you have clicked the button
        let allFixturesDiv = document.createElement("div");
        allFixturesDiv.classList.add("all-fixtures-div");
        let closeButton = document.createElement("close-button");
        allFixturesDiv.appendChild(closeButton);

        let resultsHeading = document.createElement("span");
        resultsHeading.classList.add("results-heading");
        resultsHeading.textContent = `Results`;
        allFixturesDiv.appendChild(resultsHeading);



        for (fixture of fixtures) {
            let fixtureRow = document.createElement("fixtures-row");
            fixtureRow.setAttribute("home-team-name", fixture.teams.home.name);
            fixtureRow.setAttribute("away-team-name", fixture.teams.away.name);
            fixtureRow.setAttribute("home-team-goals", fixture.goals.home);
            fixtureRow.setAttribute("away-team-goals", fixture.goals.away);
            allFixturesDiv.appendChild(fixtureRow);
        }
        // The allFixturesDiv has 7 fixtures-row, 7 divs.

        // Here I care only about the content of DataDivOne
        if (dataDivOne.querySelector(".all-fixtures-div")) {
            if (dataDivTwo.querySelector(".all-fixtures-div")) {
                clearDataDivTwo();
                dataDivTwo.appendChild(allFixturesDiv);
                closeButton.setAttribute("onclick", "clearDataDivTwo()");
                dataDivTwo.classList.add("show");
            } else {
                dataDivTwo.appendChild(allFixturesDiv);
                closeButton.setAttribute("onclick", "clearDataDivTwo()");
                dataDivTwo.classList.add("show");
            }
        } else {
            dataDivOne.appendChild(allFixturesDiv);
            closeButton.setAttribute("onclick", "clearDataDivOne()");
            dataDivOne.classList.add("show");
        }


    }


    function clearDataDivOne() {
        dataDivOne.classList.remove("show");
        dataDivOne.querySelector(".all-fixtures-div").remove();
    }

    function clearDataDivTwo() {
        dataDivTwo.classList.remove("show");
        dataDivTwo.querySelector(".all-fixtures-div").remove();
    }




</script>

</html>