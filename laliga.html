<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./assets/components/navigation/navigation.css">
    <link rel="stylesheet" href="./assets/components/fixtures-row/fixtures-row.css">
    <link rel="stylesheet" href="./assets/components/close-button/close-button.css">
    <link rel="stylesheet" href="./assets/components/single-team-container/single-team-container.css">
    <link rel="stylesheet" href="./assets/components/next-fixture-row/next-fixture-row.css">
    <link rel="stylesheet" href="./home.css" type="text/css">
</head>

<body>
    <navigation-custom></navigation-custom>

    <section class="laptop-next-fixtures">
        <div class="keyboard-screen">
            <div class="screen">
                <div class="data-div data-div-one"> </div>
                <div class="data-div data-div-two"></div>
            </div>

            <div class="all-teams-container"> </div>
        </div>

        <div class="next-fixtures-container"> </div>
    </section>



    <script src="./functions.js"></script>
    <script src="https://kit.fontawesome.com/50ab0d686f.js" crossorigin="anonymous"></script>
    <script src="./assets/components/navigation/navigation.js"></script>
    <script src="./assets/components/close-button/close-button.js"></script>
    <script src="./assets/components/fixtures-row/fixtures-row.js"></script>
    <script src="./assets/components/single-team-container/single-team-container.js" type="module" defer></script>
    <script src="./assets/components/next-fixture-row/next-fixture-row.js"></script>
    <script src="./laliga-functions.js"></script>
</body>
<script>


    const leagueId = 140;

    async function renderTeams(leagueId) {
        const allLeagueTeams = await readyAllTeams(leagueId);
        console.log("allLeagueTeams", allLeagueTeams);
        const allTeamsContainer = document.querySelector(".all-teams-container");
        const allTeamsArray = Object.entries(allLeagueTeams);
        console.log("allTeamsArray in qiestion", allTeamsArray);
        allTeamsArray.forEach((team) => {
            const teamId = team[1].id;
            console.log("teamId in question", teamId);
            const teamName = team[1].name;
            const teamLogo = team[1].logo;
            const teamNameOneWord = teamName.split(" ")[0];
            console.log("teamNameOneWord", teamNameOneWord);
            const teamContainer = document.createElement("single-team-container");
            teamContainer.classList.add("team-div");
            teamContainer.classList.add(teamNameOneWord);
            teamContainer.setAttribute("team-id", teamId);
            teamContainer.setAttribute("team-name", teamName);
            teamContainer.setAttribute("team-logo", teamLogo);
            allTeamsContainer.appendChild(teamContainer);
        })
    }

    renderTeams(leagueId);


    const screen = document.querySelector(".screen");
    const dataDivOne = document.querySelector(".data-div-one");
    const dataDivTwo = document.querySelector(".data-div-two");


    const headers = {
        "x-rapidapi-host": "v3.football.api-sports.io",
        "x-rapidapi-key": "94d01bff67718f85de3f0532069fbbf1",
    };

    // The clickedTeamFixturesArray is passed where the function is called in the
    async function displayTeamFixtures(teamId) {
        console.log("teamId in", teamId);
        const response = await fetch(`https://v3.football.api-sports.io/fixtures?team=${teamId}&league=${leagueId}&season=2025&last=10`, { headers });
        const responseJson = await response.json();
        const fixtures = responseJson.response;
        console.log("fixtures i function", fixtures);

        // Huge: allFixturesDiv is created only once you have clicked the button
        let allFixturesDiv = document.createElement("div");
        allFixturesDiv.classList.add("all-fixtures-div");
        let closeButton = document.createElement("close-button");
        allFixturesDiv.appendChild(closeButton);

        let resultsHeading = document.createElement("h2");
        resultsHeading.classList.add("results-heading");
        resultsHeading.textContent = `Results`;
        allFixturesDiv.appendChild(resultsHeading);



        for (fixture of fixtures) {
            let fixtureRow = document.createElement("fixtures-row");
            fixtureRow.setAttribute("home-team-name", fixture.teams.home.name);
            fixtureRow.setAttribute("away-team-name", fixture.teams.away.name);
            fixtureRow.setAttribute("home-team-goals", fixture.goals.home);
            fixtureRow.setAttribute("away-team-goals", fixture.goals.away);
            allFixturesDiv.appendChild(fixtureRow);
        }
        // The allFixturesDiv has 7 fixtures-row, 7 divs.

        // Here I care only about the content of DataDivOne
        if (dataDivOne.querySelector(".all-fixtures-div")) {
            if (dataDivTwo.querySelector(".all-fixtures-div")) {
                clearDataDivTwo();
                dataDivTwo.appendChild(allFixturesDiv);
                closeButton.setAttribute("onclick", "clearDataDivTwo()");
                dataDivTwo.classList.add("show");
            } else {
                dataDivTwo.appendChild(allFixturesDiv);
                closeButton.setAttribute("onclick", "clearDataDivTwo()");
                dataDivTwo.classList.add("show");
            }
        } else {
            dataDivOne.appendChild(allFixturesDiv);
            closeButton.setAttribute("onclick", "clearDataDivOne()");
            dataDivOne.classList.add("show");
        }


    }


    function clearDataDivOne() {
        dataDivOne.classList.remove("show");
        dataDivOne.querySelector(".all-fixtures-div").remove();
    }

    function clearDataDivTwo() {
        dataDivTwo.classList.remove("show");
        dataDivTwo.querySelector(".all-fixtures-div").remove();
    }


</script>

</html>